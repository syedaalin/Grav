((function(){if(!Element.prototype.matches){Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;}
var findAncestor=function(el,selector){while((el=el.parentElement)&&!((el.matches||el.matchesSelector).call(el,selector))){}
return el;};var fields=document.querySelectorAll('input[name="searchfield"][data-search-input]');Array.prototype.forEach.call(fields,function(field){var form=findAncestor(field,'form[data-simplesearch-form]'),min=field.getAttribute('data-min')||false,location=field.getAttribute('data-search-input'),separator=field.getAttribute('data-search-separator');if(min){var invalid=field.getAttribute('data-search-invalid');field.addEventListener('keydown',function(){field.setCustomValidity(field.value.length>=min?'':invalid);});}
form.addEventListener('submit',function(event){event.preventDefault();if(field.checkValidity()){window.location.href=location+separator+field.value;}});});})());;
document.addEventListener('DOMContentLoaded',function(){const emailElements=document.querySelectorAll('.email-obfuscated');emailElements.forEach(function(el){const user=el.dataset.user.split('').reverse().join('');const domain=el.dataset.domain.split('').reverse().join('');const email=user+'@'+domain;const link=document.createElement('a');link.href='mailto:'+email;link.textContent=email;link.className=el.className.replace('email-obfuscated','');el.parentNode.replaceChild(link,el);});});;
document.addEventListener('DOMContentLoaded',()=>{const animatedElements=document.querySelectorAll('[data-aos]');const observerOptions={threshold:0.1,rootMargin:'0px 0px -50px 0px'};const observer=new IntersectionObserver((entries)=>{entries.forEach(entry=>{if(entry.isIntersecting){entry.target.classList.add('aos-animate');observer.unobserve(entry.target);}});},observerOptions);animatedElements.forEach(el=>observer.observe(el));});;
const ThemeCore={init:function(){this.initHaptics();this.initSpatial();this.initAgentic();this.initPredictive();},initSpatial:function(){try{if(window.DeviceOrientationEvent&&'ontouchstart'in window){document.body.classList.add('spatial-ready');console.log('Gravity: Spatial Hardware Detected');window.addEventListener('deviceorientation',(event)=>{try{const tiltX=event.gamma;const tiltY=event.beta;const layers=document.querySelectorAll('.spatial-layer');layers.forEach(layer=>{const depth=layer.getAttribute('data-depth')||0.05;layer.style.transform=`translate(${tiltX * depth}px, ${tiltY * depth}px)`;});}catch(e){console.warn('Gravity: Spatial orientation error:',e);}});}}catch(e){console.warn('Gravity: Spatial initialization failed:',e);}},initHaptics:function(){if(!navigator.vibrate)return;const hapticEnabled=document.body.dataset.haptics==='true';const vibrate=(pattern=10)=>{try{navigator.vibrate(pattern);}catch(e){console.warn('Gravity: Haptic vibration failed:',e);}};if(hapticEnabled){try{const vibratingElements=document.querySelectorAll('a, button, .btn, .social-btn');vibratingElements.forEach(el=>{if(!el.hasAttribute('data-haptic')){el.addEventListener('click',()=>vibrate(10));}});}catch(e){console.warn('Gravity: Global haptics initialization failed:',e);}}
try{const explicitHapticElements=document.querySelectorAll('[data-haptic="true"]');explicitHapticElements.forEach(el=>{el.addEventListener('click',(e)=>{vibrate(15);});});if(hapticEnabled||explicitHapticElements.length>0){console.log('Gravity: Haptic Feedback Active');}}catch(e){console.warn('Gravity: Explicit haptics initialization failed:',e);}},initAgentic:function(){const agentActions=document.querySelectorAll('[data-agent-action]');if(agentActions.length>0){console.log(`Gravity: Found ${agentActions.length} agentic actions.`);}},initPredictive:function(){try{if(HTMLScriptElement.supports&&HTMLScriptElement.supports('speculationrules')){const speculationRules={"prerender":[{"where":{"and":[{"href_matches":"/*"},{"not":{"href_matches":"/admin/*"}},{"not":{"selector_matches":"a[target='_blank']"}}]},"eagerness":"moderate"}],"prefetch":[{"where":{"href_matches":"/*"},"eagerness":"conservative"}]};const script=document.createElement('script');script.type='speculationrules';script.textContent=JSON.stringify(speculationRules);document.head.appendChild(script);console.log('Gravity: Speculation Rules API Active (Next Paint < 50ms)');}else{this.initBasicPrefetch();}}catch(e){console.warn('Gravity: Speculation Rules API failed, using fallback:',e);this.initBasicPrefetch();}},initBasicPrefetch:function(){try{const links=document.querySelectorAll('a:not([target="_blank"]):not([href^="#"])');links.forEach(link=>{link.addEventListener('mouseenter',()=>{try{const url=link.href;if(!url||url.includes('/admin/'))return;if(!document.querySelector(`link[rel="prefetch"][href="${url}"]`)){const prefetch=document.createElement('link');prefetch.rel='prefetch';prefetch.href=url;document.head.appendChild(prefetch);}}catch(e){}});});console.log('Gravity: Basic Prefetch Active (Fallback)');}catch(e){console.warn('Gravity: Basic prefetch initialization failed:',e);}}};document.addEventListener('DOMContentLoaded',()=>{try{ThemeCore.init();}catch(e){console.error('Gravity: Theme initialization failed:',e);}});;

<style>
/* ==========================================================================
   DYNAMIC THEME VARIABLES (Generated from Admin Config)
   2026 Standards: OKLCH Colors, Self-Hosted Fonts, Modern CSS
   ========================================================================== */

/* SELF-HOSTED FONTS (GDPR Compliant - Rule 5.1) */
{% set font_primary = theme_var('token_font_body')|default('Outfit') %}
{% set font_primary_file = font_primary|replace({' ': ''}) %}

{# Primary Font #}
@font-face {
    font-family: '{{ font_primary }}';
    font-style: normal;
    font-weight: 400;
    font-display: swap;
    src: url('{{ url("theme://fonts/" ~ font_primary_file ~ "-400.woff2") }}') format('woff2');
}
@font-face {
    font-family: '{{ font_primary }}';
    font-style: normal;
    font-weight: 700;
    font-display: swap;
    src: url('{{ url("theme://fonts/" ~ font_primary_file ~ "-700.woff2") }}') format('woff2');
}

{# Header Font (if different) #}
{% set font_header = theme_var('token_font_header')|default('Outfit') %}
{% if font_header != font_primary and font_header != '' %}
    {% set font_header_file = font_header|replace({' ': ''}) %}
    @font-face {
        font-family: '{{ font_header }}';
        font-style: normal;
        font-weight: 700;
        font-display: swap;
        src: url('{{ url("theme://fonts/" ~ font_header_file ~ "-700.woff2") }}') format('woff2');
    }
{% endif %}

   ======================================================================= */
/* 
   Fluid Typography Logic (2026 Standard)
   Uses clamp() for smooth scaling between viewport widths (320px - 1200px)
*/
{% set min_size = theme_var('token_typo_min_size')|default(16) %}
{% set max_size = theme_var('token_typo_max_size')|default(18) %}
{% set scale = theme_var('token_typo_scale')|default(1.25) %}
{% set fluid_enabled = theme_var('token_typo_fluid') %}

{# Linear Interpolation Slope (y = mx + c) #}
{# slope = (max_size - min_size) / (max_width - min_width) #}
{# 1200 - 320 = 880 #}
{% set slope = (max_size - min_size) / 880 %}
{% set intercept = min_size - (slope * 320) %}

:root {
    /* =======================================================================
       1. COLOR SYSTEM (OKLCH 2026 Standard + Hex Fallback)
       Perceptually uniform color space for accurate lightness manipulation
       ======================================================================= */
    
    /* Brand Colors - Hex Fallback */
    {% set p_hex = theme_var('token_color_primary')|default('#3b4252') %}
    {% set s_hex = theme_var('token_color_secondary')|default('#88c0d0') %}
    {% set a_hex = theme_var('token_color_accent')|default('#bf616a') %}
    
    --brand-primary: {{ (p_hex|iterable ? p_hex|first : p_hex)|e('html') }};
    --brand-secondary: {{ (s_hex|iterable ? s_hex|first : s_hex)|e('html') }};
    --brand-accent: {{ (a_hex|iterable ? a_hex|first : a_hex)|e('html') }};
    
    /* Surface Colors - Hex Fallback */
    --bg-body: {{ theme_var('token_color_bg_body')|default('#eceff4') }};
    --bg-card: {{ theme_var('token_color_bg_card')|default('#ffffff') }};
    --text-main: {{ theme_var('token_color_text_main')|default('#2e3440') }};
    --text-muted: {{ theme_var('token_color_text_muted')|default('#4c566a') }};
    


    
    /* 2. SHAPES & UI */
    --radius-main: {{ theme_var('physic_radius_main')|default('12px') }};
    --glass-opacity: {{ theme_var('physic_glass_opacity')|default(0.85) }};
    --glass-blur: blur({{ theme_var('physic_glass_blur')|default(20) }}px) saturate(180%);

    /* Neomorphism System (2026) */
    {% set neo_strength = theme_var('physic_neo_strength')|default(0) %}
    {% set neo_light = theme_var('physic_neo_lightSource')|default('top-left') %}
    
    {% if neo_strength > 0 %}
        --neo-dist: {{ neo_strength * 6 }}px;
        --neo-blur: {{ neo_strength * 12 }}px;
        --neo-op-dark: {{ neo_strength * 0.15 }};
        --neo-op-light: {{ neo_strength * 0.8 }};
        
        {% if neo_light == 'top-left' %}
            --neo-shadow: var(--neo-dist) var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                          calc(var(--neo-dist) * -1) calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
            --neo-shadow-inset: inset var(--neo-dist) var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                                inset calc(var(--neo-dist) * -1) calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
        {% elseif neo_light == 'top-right' %}
            --neo-shadow: calc(var(--neo-dist) * -1) var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                          var(--neo-dist) calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
            --neo-shadow-inset: inset calc(var(--neo-dist) * -1) var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                                inset var(--neo-dist) calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
        {% else %}
            --neo-shadow: 0 var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                          0 calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
            --neo-shadow-inset: inset 0 var(--neo-dist) var(--neo-blur) oklch(0% 0 0 / var(--neo-op-dark)), 
                                inset 0 calc(var(--neo-dist) * -1) var(--neo-blur) oklch(100% 0 0 / var(--neo-op-light));
        {% endif %}
    {% else %}
        --neo-shadow: 0 4px 6px -1px oklch(0% 0 0 / 0.1), 0 2px 4px -2px oklch(0% 0 0 / 0.1);
        --neo-shadow-inset: inset 0 2px 4px 0 oklch(0% 0 0 / 0.06);
    {% endif %}
    
    /* BACKGROUND BUILDER 2026 (Dynamic Modes) */
    {% set bg_mode = theme_var('agent_env_mode')|default(0) %}
    
    {% if bg_mode == 0 %}
        /* Mode: Solid Color (Default) */
        {% set s_col = theme_var('agent_env_solid_col')|default('#ffffff') %}
        --bg-pattern: linear-gradient({{ s_col }}, {{ s_col }});
        --bg-size: auto;
        --bg-fixed: scroll;
        --bg-anim: none;

    {% elseif bg_mode == 1 %}
        /* Mode: Gradient */
        {% set g_type = theme_var('agent_env_grad_type')|default('linear') %}
        {% set g_angle = theme_var('agent_env_grad_angle')|default(135) %}
        {% set g_start = theme_var('agent_env_grad_start')|default('#3b4252') %}
        {% set g_end = theme_var('agent_env_grad_end')|default('#88c0d0') %}
        
        {% if g_type == 'linear' %}
            --bg-pattern: linear-gradient({{ g_angle }}deg, {{ g_start }}, {{ g_end }});
        {% else %}
            --bg-pattern: radial-gradient(circle at center, {{ g_start }}, {{ g_end }});
        {% endif %}
        --bg-size: 100% 100%;
        --bg-fixed: fixed;
        --bg-anim: none;

    {% elseif bg_mode == 2 %}
        /* Mode: Background Image */
        {% set bg_img = theme_var('agent_env_img') ? url('theme://images/backgrounds/' ~ theme_var('agent_env_img').name) : '' %}
        {% set bg_pos = theme_var('agent_env_img_pos')|default('center center') %}
        {% set bg_size = theme_var('agent_env_img_size')|default('cover') %}
        {% set bg_attach = theme_var('agent_env_img_attach')|default('fixed') %}
        {% set ov_col = theme_var('agent_env_img_overlay')|default('#000000') %}
        {% set ov_op = theme_var('agent_env_img_op')|default(0.3) %}
        
        /* Image with Overlay using Linear-Gradient Trick */
        {% if bg_img %}
            --bg-pattern: linear-gradient(color-mix(in srgb, {{ ov_col }}, transparent {{ (1 - ov_op) * 100 }}%), color-mix(in srgb, {{ ov_col }}, transparent {{ (1 - ov_op) * 100 }}%)), url('{{ bg_img }}');
        {% else %}
            --bg-pattern: none; 
        {% endif %}
        
        --bg-size: {{ bg_size }};
        --bg-position: {{ bg_pos }};
        --bg-fixed: {{ bg_attach }};
        --bg-anim: none;

    {% elseif bg_mode == 3 %}
        /* Mode: Aurora Mesh (Animated) */
        {% set m_c1 = theme_var('agent_env_mesh_1')|default('#3b4252') %}
        {% set m_c2 = theme_var('agent_env_mesh_2')|default('#bf616a') %}
        {% set m_c3 = theme_var('agent_env_mesh_3')|default('#88c0d0') %}
        {% set m_speed = theme_var('agent_env_mesh_speed')|default(20) %}

        --bg-pattern: 
            radial-gradient(at 0% 0%, {{ m_c1 }} 0px, transparent 50%),
            radial-gradient(at 100% 0%, {{ m_c2 }} 0px, transparent 50%),
            radial-gradient(at 100% 100%, {{ m_c3 }} 0px, transparent 50%),
            radial-gradient(at 0% 100%, {{ m_c1 }} 0px, transparent 50%);
        --bg-size: 200% 200%;
        --bg-fixed: fixed;
        --bg-anim: auroraMesh {{ m_speed }}s ease infinite alternate;

    {% elseif bg_mode == 4 %}
        /* Mode: Legacy Pattern */
        {% set tex = theme_var('agent_env_tex')|default('none') %}
        {% set op = theme_var('agent_env_tex_op')|default(0.05) %}
        {% set tex_col = theme_var('agent_env_tex_col')|default('#000000') %}
        {% set tex_col_encoded = tex_col|replace({'#': '%23'}) %}
        {% set mix_col = "color-mix(in srgb, " ~ tex_col ~ ", transparent " ~ ((1 - op) * 100)|round ~ "%)" %}

        {% if tex == 'noise' %}
            --bg-pattern: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' fill='{{ tex_col_encoded }}' opacity='{{ op }}' type='matrix'/%3E%3C/svg%3E");
            --bg-size: 100% 100%;
        {% elseif tex == 'dots' %}
            --bg-pattern: radial-gradient({{ mix_col }} 1px, transparent 1px);
            --bg-size: 20px 20px;
        {% elseif tex == 'grid' %}
            --bg-pattern: linear-gradient({{ mix_col }} 1px, transparent 1px), linear-gradient(90deg, {{ mix_col }} 1px, transparent 1px);
            --bg-size: 30px 30px;
        {% else %}
             --bg-pattern: none;
             --bg-size: auto;
        {% endif %}
        --bg-fixed: scroll;
        --bg-anim: none;
    {% endif %}

    {% if theme_var('physic_vignette_enabled') %}
        --vignette-display: block;
    {% else %}
        --vignette-display: none;
    {% endif %}
    

    
    /* 3. LAYOUT & SPACING */
    --site-width: {{ theme_var('container_width')|default(1200) }}px;
    --space-unit: {{ theme_var('spacing_scale')|default(1.0) }}rem; 
    
    /* 4. LOGO */
    --logo-h-desktop: {{ theme_var('logo_height')|default(48) }}px;
    --logo-h-mobile: {{ theme_var('logo_height_mobile')|default(32) }}px;
    
    /* 5. FLUID TYPOGRAPHY VARIABLES */
    {% if fluid_enabled %}
        /* min + (max-min) * ((100vw - 320px) / (1200 - 320)) simplified */
        --font-base: clamp({{ min_size }}px, {{ intercept|number_format(4) }}px + {{ (slope * 100)|number_format(4) }}vw, {{ max_size }}px);
    {% else %}
        --font-base: {{ min_size }}px;
    {% endif %}

    --scale-ratio: {{ scale }};
    
    /* Micro-Typography */
    --line-height-body: {{ theme_var('token_typo_lh_body')|default(1.6) }};
    --line-height-heading: {{ theme_var('token_typo_lh_heading')|default(1.2) }};
    --tracking-heading: {{ theme_var('token_typo_ls_heading')|default(-0.02) }}em;
    --measure: {{ theme_var('token_typo_measure')|default(65) }}ch;

    --heading-3: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio));
    --heading-2: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio));
    --heading-1: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio));
}

/* =======================================================================
   OKLCH UPGRADE (Progressive Enhancement for Modern Browsers)
   Chrome 111+, Safari 15.4+, Firefox 113+ (~95% browser coverage)
   ======================================================================= */
@supports (color: oklch(0 0 0)) {
    :root {
        /* Upgrade to OKLCH for perceptual uniformity */
        --brand-primary: oklch(0.34 0.02 257);      /* Dark blue-gray */
        --brand-secondary: oklch(0.75 0.08 211);    /* Light cyan */
        --brand-accent: oklch(0.59 0.12 17);        /* Muted red */
        
        --bg-body: oklch(0.94 0.01 257);            /* Very light gray */
        --bg-card: oklch(1.0 0 0);                  /* Pure white */
        --text-main: oklch(0.29 0.02 257);          /* Dark gray (APCA Lc ~80) */
        --text-muted: oklch(0.43 0.03 257);         /* Medium gray (APCA Lc ~65) */
        

        
        /* Auto-generated palette variants using relative color syntax */
        --brand-primary-light: oklch(from var(--brand-primary) calc(l + 0.15) c h);
        --brand-primary-dark: oklch(from var(--brand-primary) calc(l - 0.1) c h);
        --brand-primary-vivid: oklch(from var(--brand-primary) l calc(c * 1.5) h);
        --brand-primary-muted: oklch(from var(--brand-primary) l calc(c * 0.5) h);
        --brand-primary-alpha: oklch(from var(--brand-primary) l c h / 0.8);
        
        --brand-secondary-light: oklch(from var(--brand-secondary) calc(l + 0.1) c h);
        --brand-secondary-dark: oklch(from var(--brand-secondary) calc(l - 0.1) c h);
        
        --brand-accent-hover: oklch(from var(--brand-accent) calc(l + 0.1) c h);
        --brand-accent-active: oklch(from var(--brand-accent) calc(l - 0.1) c h);
        

        --glass-bg: oklch(from var(--bg-card) l c h / var(--glass-opacity, 0.85));
    }
}

/* =======================================================================
   REDUCED MOTION (Accessibility & Sustainability)
   ======================================================================= */
@media (prefers-reduced-motion: reduce) {
    :root {
        --bg-anim: none !important;
        --vignette-display: none !important;
        scroll-behavior: auto !important;
    }
    
    *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
    }
}

/* =======================================================================
   TYPOGRAPHY (2026 Standard - Rule 3.2)
   ======================================================================= */
body { 
    font-family: '{{ theme_var('token_font_body')|default('Outfit') }}', system-ui, -apple-system, sans-serif !important; 
    font-size: var(--font-base);
    line-height: var(--line-height-body);
}

h1, h2, h3, h4, h5, h6 {
    font-family: '{{ theme_var('token_font_header')|default(theme_var('token_font_body'))|default('Outfit') }}', system-ui;
    line-height: var(--line-height-heading);
    letter-spacing: var(--tracking-heading);
    font-weight: 700;
}

/* Modular Scale */
h6 { font-size: var(--font-base); }
h5 { font-size: calc(var(--font-base) * var(--scale-ratio)); }
h4 { font-size: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio)); }
h3 { font-size: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio)); }
h2 { font-size: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio)); }
h1 { font-size: calc(var(--font-base) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio) * var(--scale-ratio)); }

p, li, article {
    max-width: var(--measure);
}

/* =======================================================================
   MODERN CSS 2026 FEATURES
   ======================================================================= */

/* Text Wrapping (2026 Standard - Rule 3.2) */
h1, h2, h3, h4, h5, h6 {
    text-wrap: balance; /* Prevents orphans in headings */
}

p, li {
    text-wrap: pretty; /* Optimizes paragraph line breaks */
}

/* Performance Optimization */
.cognitive-nav__sublist,
.course-grid,
.service-grid {
    content-visibility: auto; /* Virtualizes off-screen content */
    contain-intrinsic-size: auto 500px; /* Estimated height for layout calculations */
}



/* Focus Outline Enhancement (WCAG 3.0) */
*:focus-visible {
    outline: 3px solid var(--brand-accent);
    outline-offset: 2px;
    border-radius: 2px;
}

/* =======================================================================
   DARK MODE SUPPORT (OKLCH-based)
   ======================================================================= */
@media (prefers-color-scheme: dark) {
    :root {
        --bg-body: oklch(15% 0.01 250);
        --bg-card: oklch(22% 0.01 250);
        --text-main: oklch(90% 0.01 250);
        --text-muted: oklch(65% 0.01 250);
        --glass-bg: oklch(22% 0.01 250 / var(--glass-opacity, 0.85));
    }
    
    body {
        background-color: var(--bg-body);
        color: var(--text-main);
    }
    
    .course-card,
    .service-card,
    .quote-box,
    .popular-course-card {
        background: var(--bg-card);
        border-color: oklch(100% 0 0 / 0.1);
    }
    
    .quote-box p,
    .course-info span {
        color: var(--text-muted);
    }
    

}
/* FIX: Logo Constraints for Semantic Markup (CLS Prevention) */

/* Aurora Mesh Animation */
@keyframes auroraMesh {
    0% { background-position: 0% 50%; border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; }
    50% { background-position: 100% 50%; border-radius: 60% 40% 30% 70% / 60% 50% 40% 50%; }
    100% { background-position: 0% 50%; border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; }
}
/* =======================================================================
   UI EFFECTS OVERRIDES (Applying Global Settings)
   ======================================================================= */
.glass-panel, 
.service-card, 
.course-card, 
.quote-box, 
.hero-banner, 
.popular-course-card,
.social-btn,
.btn-primary,
.btn-secondary {
    box-shadow: var(--neo-shadow) !important;
}

.glass-panel, .course-card {
    backdrop-filter: var(--glass-blur) !important;
    -webkit-backdrop-filter: var(--glass-blur) !important;
}

input:focus, textarea:focus, select:focus {
    box-shadow: var(--neo-shadow-inset) !important;
}

/* Ensure glass background uses dynamic opacity */
:root {
    --glass-bg: oklch(100% 0 0 / var(--glass-opacity, 0.85));
}

/* =======================================================================
   ADAPTIVE UX PROTOCOLS (Sentient Rule 1.2 & 3.3)
   ======================================================================= */

/* 1. RADICAL SUSTAINABILITY (ECO MODE) */
body.eco-mode {
    --bg-anim: none !important;
    --glass-blur: blur(0px) !important;
    --neo-shadow: 0 2px 4px oklch(0% 0 0 / 0.1) !important;
    --neo-shadow-inset: none !important;
}
body.eco-mode .aurora-mesh, 
body.eco-mode .hero-video, 
body.eco-mode .animated-blob {
    display: none !important;
}

/* 2. COGNITIVE FOCUS MODE */
body.focus-mode {
    --vignette-display: none !important;
    --glass-opacity: 1 !important;
    --bg-pattern: none !important;
    background-color: var(--bg-body) !important;
}
body.focus-mode .hero-banner,
body.focus-mode .side-widgets,
body.focus-mode .decorative-divider {
    display: none !important;
}
body.focus-mode article, 
body.focus-mode p {
    font-size: 1.1em;
    line-height: 1.8;
}

/* 3. BIONIC READING (Neuro-Inclusion - Rule 3.2) */
.bionic-bold {
    font-weight: 600;
    color: var(--text-main);
}

/* Reduce weight slightly in focus mode for optimal readability */
body.focus-mode .bionic-bold {
    font-weight: 500;
    opacity: 0.95;
}

</style>

{# NO EXTERNAL FONT LOADING - Fonts are self-hosted via @font-face above (GDPR Compliant) #}

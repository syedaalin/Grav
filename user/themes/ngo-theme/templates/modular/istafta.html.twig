{# 
   Istafta (Religious Q&A) Module
   @desc Accordion-style FAQ for religious inquiries with 'Ask a Scholar' CTA.
   @version 2026.1.0
#}

{% import 'macros/components.html.twig' as components %}

<section class="istafta-section py-32 bg-brand-bg relative @container [content-visibility:auto] [contain-intrinsic-size:600px]">
    <div class="container mx-auto px-6 max-w-4xl">
        <header class="text-center mb-20 space-y-6">
            <span class="text-xs font-black uppercase tracking-[0.4em] text-brand-secondary">Guidance & Fiqh</span>
            <h2 class="text-h2 font-black text-brand-dark tracking-tighter leading-tightest">
                Common Inquiries (Istafta)
            </h2>
            <p class="text-lg text-brand-dark/60 max-w-2xl mx-auto font-medium leading-relaxed">
                Clarifications on modern business ethics, family matters, and religious duties from our board of certified scholars.
            </p>
        </header>

        {# Accordion Container #}
        <div class="space-y-4 mb-20">
            {% set faq_items = page.header.faqs|default(config.theme.faq_list)|default([
                {'q': 'Is dropshipping permissible in Islamic finance?', 'a': 'Yes, provided you own the goods or have a wakalah (agency) agreement with the supplier before selling to the end customer. Short-selling is prohibited.'},
                {'q': 'How do I calculate Khums on unvested stock options?', 'a': 'Khums is only applicable on assets you have actual possession of or ability to liquidate. Unvested options are generally exempt until vested and held for a year.'},
                {'q': 'Can I pay Zakat to a non-Muslim charity?', 'a': 'Zakat is specific to Muslim beneficiaries (with exceptions for those whose hearts are to be reconciled). General charity (Sadaqah) can be given to anyone.'}
            ]) %}

            {% for item in faq_items %}
                <details class="group p-6 bg-white border border-glass-border rounded-[2rem] open:bg-white open:shadow-xl open:border-brand-primary/20 transition-all duration-500 cursor-pointer">
                    <summary class="flex items-center justify-between gap-6 list-none font-bold text-lg text-brand-dark group-hover:text-brand-primary transition-colors min-h-[44px]">
                        <span>{{ item.q }}</span>
                        <span class="w-8 h-8 flex items-center justify-center bg-surface-sunken rounded-full text-brand-gray group-open:bg-brand-primary group-open:text-white group-open:rotate-180 transition-all duration-500">
                            <span class="la la-angle-down"></span>
                        </span>
                    </summary>
                    <div class="mt-4 pt-4 border-t border-dashed border-glass-border text-brand-gray leading-relaxed group-open:animate-in group-open:fade-in group-open:slide-in-from-top-2">
                        {{ item.a }}
                    </div>
                </details>
            {% endfor %}
        </div>

        {# Ask a Scholar CTA #}
        <div class="bg-brand-dark rounded-[3rem] p-12 text-center text-white shadow-2xl relative overflow-hidden">
            <div class="relative z-10 space-y-8">
                <div class="max-w-xl mx-auto space-y-4">
                    <h3 class="text-3xl font-black tracking-tight">Have a Specific Question?</h3>
                    <p class="text-white/60 font-medium">
                        Submit your inquiry securely. Our scholars review questions every Thursday. Privacy is guaranteed.
                    </p>
                </div>
                <div class="flex flex-col @sm:flex-row justify-center gap-4">
                    {{ components.cta_button('Ask a Scholar', '/contact/ask', 'primary', 'pen-alt') }}
                    {{ components.cta_button('View Fatwa Archive', '/fatwas', 'glass', 'book-open') }}
                </div>
            </div>
            
            {# Background Decor #}
            <div class="absolute top-0 left-0 w-full h-full opacity-20 pointer-events-none">
                 <div class="absolute -top-24 -left-24 w-64 h-64 bg-brand-secondary rounded-full blur-[80px]"></div>
                 <div class="absolute -bottom-24 -right-24 w-64 h-64 bg-brand-primary rounded-full blur-[80px]"></div>
            </div>
        </div>
    </div>
</section>

{% import "macros/components.html.twig" as components %}

<section class="py-24 bg-surface-sunken relative overflow-hidden @container [content-visibility:auto] [contain-intrinsic-size:800px]">
    <div class="container mx-auto px-6 max-w-container">
        <div class="flex flex-wrap items-end justify-between mb-12 gap-6">
            <div class="max-w-xl">
                 <span class="block text-brand-primary font-bold tracking-widest uppercase text-sm mb-4">Shop & Support</span>
                <h2 class="text-h2 font-black text-brand-dark leading-tight">
                    {{ page.header.title|default('Community Store') }}
                </h2>
                <p class="text-brand-gray mt-4">
                    {{ page.content|raw }}
                </p>
            </div>
             <div class="flex gap-2">
                <button class="w-12 h-12 rounded-full border border-brand-dark/10 flex items-center justify-center hover:bg-brand-primary hover:text-white transition-colors" aria-label="Previous Slide">
                    <i class="las la-angle-left"></i>
                </button>
                <button class="w-12 h-12 rounded-full border border-brand-dark/10 flex items-center justify-center hover:bg-brand-primary hover:text-white transition-colors" aria-label="Next Slide">
                    <i class="las la-angle-right"></i>
                </button>
            </div>
        </div>

        {# Products Grid (Carousel behavior would need JS, falling back to Grid for MVP) #}
        <!-- In a real implementation, wrap this in a Swiper/Glide container -->
        <div class="grid grid-cols-1 @sm:grid-cols-2 @lg:grid-cols-4 gap-6">
            {% set products = page.collection|default(config.theme.products_list) %}
            {% for product in products %}
                {# Assuming products are child pages or defined in frontmatter #}
                {# If using a shopping cart plugin, logic here would be specific to that plugin #}
                {# For now, mock cards using the macro #}
                
                {{ components.product_card(
                    (product.media.images|first).url|default(product.image|first.url)|default('https://placehold.co/400x400'), 
                    product.title, 
                    product.header.price|default(product.price), 
                    product.header.product_type|default(product.type)|default('physical'),
                    product.url
                ) }}
            {% else %}
               {# Fallback dummy products if no collection #}
               {{ components.product_card('https://placehold.co/400x400', 'Introduction to Fiqh', '$15.00', 'digital', '#') }}
               {{ components.product_card('https://placehold.co/400x400', 'Premium Prayer Mat', '$45.00', 'physical', '#') }}
               {{ components.product_card('https://placehold.co/400x400', 'Organic Honey (500g)', '$20.00', 'physical', '#') }}
               {{ components.product_card('https://placehold.co/400x400', 'Digital Quran Pen', '$85.00', 'physical', '#') }}
            {% endfor %}
        </div>
    </div>
</section>

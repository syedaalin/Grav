@layer components {
  /* ========================================
     Header System (Consolidated)
     ======================================== */

  /* 1. Header Layout Grid
     Moved from navigation.css */
  @scope (.header-nav) {
    :scope {
      display: grid;
      grid-template-columns: 1fr auto 1fr; /* Center is always centered */
      align-items: center;
      width: 100%;
      min-height: 3.5rem;
    }

    .header-zone-a {
      grid-column: 1;
      justify-self: start;
      display: flex;
      align-items: center;
      gap: 1rem;
    }

    .header-zone-b {
      grid-column: 2;
      justify-self: center;
      display: flex;
      align-items: center;
      justify-content: center;
      width: 100%;
    }

    .header-zone-c {
        grid-column: 3;
        justify-self: end;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
  }

  /* 2. Sticky Header Wrapper */
  .header-top-sticky {
      position: sticky;
      top: 0;
      z-index: var(--z-fixed); /* Using token instead of hardcoded 10000 */
      width: 100%;
      display: block;
  }

  /* 3. Main Sticky Header (Glassmorphism & Logic) 
     Consolidated from layout.css and navigation.css */
  @scope (.header-main-sticky) {
    :scope {
      position: relative;
      z-index: var(--z-sticky);
      
      /* Glassmorphism Core */
      background: var(--glass-surface);
      backdrop-filter: blur(var(--glass-blur));
      -webkit-backdrop-filter: blur(var(--glass-blur));
      border-block-end: var(--glass-border);
      box-shadow: var(--glass-shadow);
      
      color: var(--color-text);
      padding-block: var(--header-padding);
      transition: var(--transition-smooth);
      inline-size: 100%;
      will-change: transform, background-color, padding;
      
      /* Scrolled State */
      &.is-scrolled {
          background-image: var(--glass-surface), var(--glass-noise);
          background-blend-mode: overlay, normal;
          backdrop-filter: blur(var(--glass-blur-strong));
          -webkit-backdrop-filter: blur(var(--glass-blur-strong));
          box-shadow: var(--shadow-md);
          border-block-end: var(--glass-border);
      }
    }
  }

  /* ========================================
     Header Logic States (Body Classes)
     ======================================== */

  /* Fixed Header Logic */
  body.header-fixed .header-main-sticky {
    position: sticky;
    inset-block-start: var(--header-top-offset, 0);
  }

  /* Animated Header Logic (Shrink on scroll) */
  body.header-animated .header-main-sticky {
    padding-block: var(--header-padding);
  }

  body.header-animated .header-main-sticky.is-scrolled {
    padding-block: calc(var(--header-padding) * 0.6);
    /* Increase blur/opacity slightly on scroll for readability */
    backdrop-filter: blur(var(--glass-blur-strong));
    -webkit-backdrop-filter: blur(var(--glass-blur-strong));
    background: var(--glass-surface);
  }

  /* Dark Header Logic (Dark Glass) */
  body.header-dark .header-main-sticky {
    background: linear-gradient(135deg, oklch(0.1 0 0 / 0.7), oklch(0.1 0 0 / 0.5));
    border-block-end: 1px solid oklch(1 1 1 / 0.05);
    color: white;
  }
  
  body.header-dark .header-main-sticky .nav-link {
    color: oklch(1 0 0 / 0.9);
  }

  body.header-dark .header-main-sticky .nav-link:hover,
  body.header-dark .header-main-sticky .nav-link.active {
    color: var(--color-primary);
  }

  /* Transparent Header Logic */
  body.header-transparent .header-main-sticky {
    background: transparent;
    backdrop-filter: none;
    -webkit-backdrop-filter: none;
    border-block-end: none;
    box-shadow: none;
    position: absolute;
    inset-block-start: var(--header-top-offset, 0); 
  }

  /* Transparent + Scrolled = Glass Header */
  body.header-transparent .header-main-sticky.is-scrolled {
    background: var(--glass-surface);
    backdrop-filter: blur(var(--glass-blur));
    -webkit-backdrop-filter: blur(var(--glass-blur));
    border-block-end: var(--glass-border);
    box-shadow: var(--glass-shadow);
    color: var(--color-text);
    position: sticky;
  }

  /* Transparent + Dark (Initial State) */
  body.header-transparent.header-dark .header-main-sticky:not(.is-scrolled) {
    background: transparent;
    color: oklch(1 0 0);
  }

  /* Transparent + Dark + Scrolled = Dark Glass */
  body.header-transparent.header-dark .header-main-sticky.is-scrolled {
     background: linear-gradient(135deg, oklch(0.1 0.01 260 / 0.8), oklch(0.1 0.01 260 / 0.6));
     border-block-end: 1px solid oklch(1 0 0 / 0.1);
     color: oklch(1 0 0);
  }
}

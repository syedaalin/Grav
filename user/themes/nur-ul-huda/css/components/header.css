@layer components {
  /* 
     ========================================
     HEADER COMPONENT
     Role: Site-wide navigation bar and sticky behavior
     Blueprint: [ui-layout.blueprint.md](file:///Users/syedaalin/Documents/Grav/user/themes/nur-ul-huda/blueprints/docs/ui-layout.blueprint.md)
     ========================================
  */
  /* ========================================
     Header System (Consolidated)
     ======================================== */

  /* 1. Header Layout Grid */
  @scope (.header-nav) {
    :scope {
      display: grid;
      grid-template-columns: 1fr auto 1fr; /* Center is always centered */
      align-items: center;
      inline-size: 100%;
      min-block-size: 3.5rem;
    }

    .header-zone-a {
      grid-column: 1;
      justify-self: start;
      display: flex;
      align-items: center;
      gap: var(--space-m);
    }

    .header-zone-b {
      grid-column: 2;
      justify-self: center;
      display: flex;
      align-items: center;
      justify-content: center;
      inline-size: 100%;
      gap: var(--space-l);
    }

    .header-zone-c {
      grid-column: 3;
      justify-self: end;
      display: flex;
      align-items: center;
      gap: var(--space-s);
    }
  }

  /* 2. Sticky Header Wrapper */
  .header-top-sticky {
    position: sticky;
    inset-block-start: 0;
    z-index: var(--z-fixed);
    inline-size: 100%;
    display: block;
  }

  /* 3. Main Sticky Header (Solid Logic) */
  @scope (.header-main-sticky) {
    :scope {
      position: relative;
      z-index: var(--z-popover);

      /* Liquid Glassmorphism Core */
      background: var(--glass-bg);
      backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
      -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
      background-image: var(--glass-reflection);
      background-size: 200% 200%;
      animation: glass-liquid 20s ease-in-out infinite;

      border-block-end: var(--border-thin) solid var(--glass-border);
      box-shadow: var(--glass-shadow);

      /* Transitions */
      transition: background var(--transition-smooth), padding var(--transition-smooth), box-shadow var(--transition-smooth), backdrop-filter var(--transition-smooth);

      color: var(--color-text);
      padding-block: var(--header-padding);
      inline-size: 100%;
      will-change: transform, background-color, padding;

      /* Scrolled State */
      &.is-scrolled {
        background: var(--glass-bg);
        backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        box-shadow: var(--glass-shadow);
        border-block-end: var(--border-thin) solid var(--glass-border);
        background-image: var(--glass-reflection);
      }

      /* ========================================
         Header Logic States (Body Classes)
         ======================================== */

      /* Fixed Header Logic */
      body.header-fixed & {
        position: sticky;
        inset-block-start: var(--header-top-offset, 0);
      }

      /* Animated Header Logic (Shrink on scroll) */
      body.header-animated & {
        padding-block: var(--header-padding);
      }

      body.header-animated &.is-scrolled {
        padding-block: calc(var(--header-padding) * 0.6);
        background: var(--glass-bg-hover);
        backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        border-block-end: var(--border-thin) solid var(--glass-border);
        box-shadow: var(--glass-shadow);
      }

      /* Specificity Fix: Dark + Animated + Scrolled */
      /* Dark Header & Scroll Logic (Consolidated) */
      body.header-dark &,
      body.header-dark.header-animated &.is-scrolled,
      body.header-transparent.header-dark &.is-scrolled {
        background: var(--glass-bg-dark);
        backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        border-block-end: var(--border-thin) solid var(--glass-border-dark);
        color: white;

        .nav-link {
          color: oklch(from var(--color-white) l c h / 0.9);

          &:hover,
          &.active {
            color: var(--color-primary);
          }
        }
      }

      /* Transparent Header Logic */
      body.header-transparent & {
        background: transparent;
        -webkit-backdrop-filter: none;
        backdrop-filter: none;
        border-block-end: none;
        box-shadow: none;
        position: absolute;
        inset-block-start: var(--header-top-offset, 0);
      }

      /* Transparent + Scrolled = Glassmorphic Header */
      body.header-transparent &.is-scrolled {
        background: var(--glass-bg-hover);
        backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        -webkit-backdrop-filter: blur(var(--glass-blur)) saturate(var(--glass-saturate));
        border-block-end: var(--border-thin) solid var(--glass-border);
        box-shadow: var(--glass-shadow);
        color: var(--color-text);
        position: sticky;
      }

      /* Transparent + Dark (Initial State) */
      body.header-transparent.header-dark &:not(.is-scrolled) {
        background: transparent;
        color: var(--color-white);
        border-block-end: none;
      }
    }
  }

{# Footer Template - Enhanced with Tailwind CSS v4 #}
{% set show_social = theme_var('footer_show_social')|default(true) %}
{% set copyright = theme_var('footer_copyright') %}
{% set site_name = theme_var('site_name')|default(site.title) %}
{% set direction = theme_var('direction')|default('ltr') %}
{% set footer_bg = theme_var('minaret_bg_color')|default('#111827') %}

{# Macro for Social Media Icons #}
{% macro social_icon(url, platform, icon_class, label) %}
    <a href="{{ url }}" 
       target="_blank" 
       rel="noopener noreferrer" 
       class="relative flex items-center justify-center w-[clamp(3rem,4cqw,3.75rem)] h-[clamp(3rem,4cqw,3.75rem)] rounded-full bg-[oklch(0.25_0.03_260/0.8)] backdrop-blur-sm transition-all duration-300 hover:bg-primary hover:scale-110 hover:shadow-lg hover:shadow-primary/30 group will-change-transform"
       aria-label="{{ label }}">
        <i class="{{ icon_class }} text-[clamp(1.25rem,1.5cqw,1.6rem)] transition-transform duration-300 group-hover:scale-110" aria-hidden="true"></i>
    </a>
{% endmacro %}

<footer id="footer" class="relative overflow-hidden text-[oklch(0.85_0.02_260)]" style="background-color: {{ footer_bg }};" role="contentinfo" aria-label="Site footer">
    {# Schema.org JSON-LD #}
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "{{ schema_data.orgName|e('js') }}",
        "url": "{{ url('', [], true) }}",
        {% if theme_var('custom_logo') %}
        "logo": "{{ url(theme_var('custom_logo'), [], true) }}",
        {% endif %}
        {% if schema_data.email or schema_data.phone %}
        "contactPoint": {
            "@type": "ContactPoint",
            {% if schema_data.phone %}"telephone": "{{ schema_data.phone|e('js') }}",{% endif %}
            {% if schema_data.email %}"email": "{{ schema_data.email|e('js') }}",{% endif %}
            "contactType": "customer service"
        },
        {% endif %}
        {% if schema_data.address %}
        "address": {
            "@type": "PostalAddress",
            "streetAddress": "{{ schema_data.address|e('js') }}"
        },
        {% endif %}
        "sameAs": {{ schema_data.socials|json_encode|raw }}
    }
    </script>

    {# Decorative Background Pattern #}
    <div class="absolute inset-0 opacity-5 pointer-events-none" aria-hidden="true">
        <svg class="w-full h-full" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <pattern id="footer-pattern" x="0" y="0" width="40" height="40" patternUnits="userSpaceOnUse">
                    <circle cx="20" cy="20" r="1" fill="currentColor"/>
                </pattern>
            </defs>
            <rect width="100%" height="100%" fill="url(#footer-pattern)"/>
        </svg>
    </div>

    {# Main Footer Content #}
    <div class="relative container mx-auto section-py container-px @container">
        
        {# Social Media Section #}
        {% if show_social and (theme_var('social_facebook') or theme_var('social_twitter') or theme_var('social_instagram') or theme_var('social_youtube') or theme_var('social_telegram') or theme_var('social_whatsapp')) %}
            <section class="mb-[clamp(2rem,4cqw,3.5rem)] text-center @md:text-left" aria-labelledby="footer-social-heading">
                <h2 id="footer-social-heading" class="text-white font-bold text-[clamp(1.125rem,2cqw+0.5rem,1.35rem)] uppercase tracking-wider mb-4">
                    Connect With Us
                </h2>
                <div class="flex flex-wrap justify-center @md:justify-start gap-[clamp(0.75rem,1cqw,1.25rem)]">
                    {% if theme_var('social_facebook') %}
                        {{ _self.social_icon(theme_var('social_facebook'), 'facebook', 'lab la-facebook-f', 'Visit our Facebook page') }}
                    {% endif %}
                    {% if theme_var('social_twitter') %}
                        {{ _self.social_icon(theme_var('social_twitter'), 'twitter', 'lab la-twitter', 'Follow us on Twitter') }}
                    {% endif %}
                    {% if theme_var('social_instagram') %}
                        {{ _self.social_icon(theme_var('social_instagram'), 'instagram', 'lab la-instagram', 'Follow us on Instagram') }}
                    {% endif %}
                    {% if theme_var('social_youtube') %}
                        {{ _self.social_icon(theme_var('social_youtube'), 'youtube', 'lab la-youtube', 'Subscribe to our YouTube channel') }}
                    {% endif %}
                    {% if theme_var('social_telegram') %}
                        {{ _self.social_icon(theme_var('social_telegram'), 'telegram', 'lab la-telegram', 'Join our Telegram group') }}
                    {% endif %}
                    {% if theme_var('social_whatsapp') %}
                        {{ _self.social_icon(theme_var('social_whatsapp'), 'whatsapp', 'lab la-whatsapp', 'Contact us on WhatsApp') }}
                    {% endif %}
                </div>
            </section>
        {% endif %}

        {# Main Grid #}
        <div class="grid-bento !gap-[clamp(2rem,4cqw,4rem)]">
            
            {# Brand Column #}
            <div class="flex flex-col gap-6">
                <div class="flex flex-col gap-3">
                    <h2 class="text-white font-bold text-[clamp(1.5rem,5cqw+0.5rem,2.25rem)] leading-[1.1] tracking-tighter">{{ site_name }}</h2>
                    {% if theme_var('site_tagline') %}
                        <p class="text-[oklch(0.70_0.02_260)] text-[clamp(1rem,1.2cqw,1.15rem)] leading-relaxed max-w-[20rem]">{{ theme_var('site_tagline') }}</p>
                    {% endif %}
                </div>
                
                {# Contact Information #}
                <address class="flex flex-col gap-3 not-italic">
                    {% if theme_var('contact_phone') %}
                        <a href="tel:{{ theme_var('contact_phone')|replace({' ': '', '(': '', ')': '', '-': ''}) }}" 
                           class="flex items-center gap-3 py-2 min-h-[44px] text-base font-medium text-[oklch(0.85_0.02_260)] hover:text-primary transition-colors group">
                            <span class="flex items-center justify-center shrink-0 w-11 h-11 rounded-lg bg-[oklch(0.25_0.03_260/0.5)] transition-colors duration-300 group-hover:bg-[oklch(0.65_0.22_260/0.2)]">
                                <i class="la la-phone text-xl" aria-hidden="true"></i>
                            </span>
                            <span>{{ theme_var('contact_phone') }}</span>
                        </a>
                    {% endif %}
                    
                    {% if theme_var('social_email') %}
                        <a href="mailto:{{ theme_var('social_email') }}" 
                           class="flex items-center gap-3 py-2 min-h-[44px] text-base font-medium text-[oklch(0.85_0.02_260)] hover:text-primary transition-colors group">
                            <span class="flex items-center justify-center shrink-0 w-11 h-11 rounded-lg bg-[oklch(0.25_0.03_260/0.5)] transition-colors duration-300 group-hover:bg-[oklch(0.65_0.22_260/0.2)]">
                                <i class="la la-envelope text-xl" aria-hidden="true"></i>
                            </span>
                            <span class="break-all">{{ theme_var('social_email') }}</span>
                        </a>
                    {% endif %}
                    
                    {% if theme_var('contact_address') %}
                        <div class="flex items-center gap-3 py-2 min-h-[44px] text-base font-medium text-[oklch(0.85_0.02_260)] hover:text-primary transition-colors cursor-default group">
                            <span class="flex items-center justify-center shrink-0 w-11 h-11 rounded-lg bg-[oklch(0.25_0.03_260/0.5)] transition-colors duration-300 group-hover:bg-[oklch(0.65_0.22_260/0.2)]">
                                <i class="la la-map-marker text-xl" aria-hidden="true"></i>
                            </span>
                            <span>{{ theme_var('contact_address')|nl2br }}</span>
                        </div>
                    {% endif %}
                </address>
            </div>
            
            {# Footer Navigation Columns #}
            {% set footer_columns = theme_var('footer_columns') %}
            {% if footer_columns %}
                {% for column in footer_columns %}
                    <nav class="group" aria-labelledby="footer-nav-{{ loop.index }}" data-accordion="mobile">
                        <button type="button"
                                class="flex items-center justify-between w-full py-3 min-h-[44px] text-left bg-transparent border-none text-inherit cursor-pointer @md:cursor-default @md:pointer-events-none"
                                aria-expanded="false"
                                aria-controls="footer-nav-content-{{ loop.index }}"
                                onclick="this.setAttribute('aria-expanded', this.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'); this.nextElementSibling.classList.toggle('hidden');">
                            <h3 id="footer-nav-{{ loop.index }}" class="text-white font-bold text-[clamp(1rem,1.5cqw,1.15rem)] uppercase tracking-wider">
                                {{ column.title }}
                            </h3>
                            <i class="la la-angle-down text-[1.25rem] text-[oklch(0.70_0.02_260)] transition-transform duration-300 @md:hidden group-aria-expanded:rotate-180" aria-hidden="true"></i>
                        </button>
                        
                        <div id="footer-nav-content-{{ loop.index }}"
                             class="hidden @md:block transition-all duration-300 ease-in-out"
                             aria-hidden="true">
                            {% if column.links %}
                                <ul class="flex flex-col gap-1 mt-4 list-none p-0" role="list">
                                    {% for link in column.links %}
                                        <li>
                                            <a href="{{ link.url }}" class="flex items-center gap-2 py-3 min-h-[44px] text-base text-[oklch(0.70_0.02_260)] hover:text-primary transition-all duration-300 group/link">
                                                <i class="la la-angle-{{ direction == 'rtl' ? 'left' : 'right' }} text-sm opacity-0 transition-opacity duration-300 group-hover/link:opacity-100" aria-hidden="true"></i>
                                                <span class="transition-transform duration-300 group-hover/link:translate-x-1">{{ link.text }}</span>
                                            </a>
                                        </li>
                                    {% endfor %}
                                </ul>
                            {% endif %}
                        </div>
                    </nav>
                {% endfor %}
            {% endif %}
            
        </div>
    </div>

    {# Sub-Footer #}
    <div class="relative border-t border-[oklch(0.30_0.03_260/0.5)] bg-[oklch(0.12_0.02_260/0.5)]">
        <div class="container mx-auto px-[clamp(1rem,3cqw,2rem)] py-[clamp(1.5rem,3cqw,2rem)] flex flex-col items-center gap-4 text-center @md:flex-row @md:justify-between @md:text-left content-visibility-auto">
            <div class="text-[clamp(0.875rem,1cqw,1rem)] text-[oklch(0.70_0.02_260)]">
                {% if copyright %}
                    {{ copyright|raw }}
                {% else %}
                    <p>&copy; {{ "now"|date("Y") }} {{ site_name }}. All rights reserved.</p>
                {% endif %}
            </div>
            
            <div class="flex flex-wrap items-center justify-center @md:justify-end gap-4 text-[clamp(0.875rem,1cqw,1rem)] text-[oklch(0.60_0.02_260)]">
                <span>Powered by</span>
                <a href="https://getgrav.org" target="_blank" rel="noopener noreferrer" class="font-medium text-[oklch(0.70_0.02_260)] decoration-transparent hover:text-primary hover:underline underline-offset-2 transition-colors">Grav</a>
                <span>â€¢</span>
                <a href="https://github.com/syedaalin/grav-theme-nur-ul-huda" target="_blank" rel="noopener noreferrer" class="font-medium text-[oklch(0.70_0.02_260)] decoration-transparent hover:text-primary hover:underline underline-offset-2 transition-colors">Nur-ul-Huda Theme</a>
            </div>
        </div>
    </div>
    
    {# Back to Top Button #}
    <a href="#top" 
       class="fixed bottom-6 right-6 z-40 flex items-center justify-center w-12 h-12 @sm:w-14 @sm:h-14 rounded-full bg-primary text-white shadow-lg opacity-0 pointer-events-none transition-all duration-300 hover:scale-110 hover:shadow-xl focus-visible:outline-2 focus-visible:outline-white focus-visible:outline-offset-4 [&.visible]:opacity-100 [&.visible]:pointer-events-auto [dir=rtl]&:right-auto [dir=rtl]&:left-6" 
       aria-label="Back to top" 
       data-back-to-top>
        <i class="la la-angle-up text-2xl" aria-hidden="true"></i>
    </a>
</footer>

{# 
   2026 Metadata & SEO Template
   @desc Handles OpenGraph, Twitter Cards, and PWA integration.
#}
{% set metadata = page.metadata %}
{% set seo_title = page.title ? page.title ~ ' | ' ~ site.title : site.title %}
{% set seo_description = page.header.metadata.description|default(site.metadata.description) %}
{% if seo_description is iterable %}
    {% set seo_description = seo_description|first %}
{% endif %}

{# General Meta #}
<meta name="description" content="{{ seo_description|e('html_attr') }}">
<meta name="keywords" content="{{ page.taxonomy.tag|join(', ')|default(site.metadata.keywords) }}">

{# OpenGraph #}
<meta property="og:site_name" content="{{ site.title }}">
<meta property="og:title" content="{{ seo_title }}">
<meta property="og:description" content="{{ seo_description|e('html_attr') }}">
<meta property="og:type" content="website">
<meta property="og:url" content="{{ page.url(true, true) }}">
{% if page.media.images|first %}
    <meta property="og:image" content="{{ page.media.images|first.url(true) }}">
{% elseif theme_var('custom_logo') %}
    <meta property="og:image" content="{{ url('theme://images/logo/' ~ (theme_var('custom_logo')|first).name) }}">
{% endif %}

{# Twitter Card #}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ seo_title }}">
<meta name="twitter:description" content="{{ seo_description|e('html_attr') }}">

{# PWA Support #}
<link rel="manifest" href="{{ url('theme://images/manifest.json') }}">
<meta name="theme-color" content="{{ config.theme.pwa_theme_color|default('#000000') }}">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="{{ config.theme.pwa_short_name|default(site.title) }}">

{# Additional SEO #}
{% for meta in metadata %}
    {% if meta.content is not iterable %}
        <meta {% if meta.name %}name="{{ meta.name }}"{% endif %} {% if meta.http_equiv %}http-equiv="{{ meta.http_equiv }}"{% endif %} {% if meta.property %}property="{{ meta.property }}"{% endif %} {% if meta.content %}content="{{ meta.content }}"{% endif %} />
    {% endif %}
{% endfor %}

{% extends 'partials/base.html.twig' %}

{% block content %}
    <div class="courses-intro">
        {{ content|raw }}
    </div>

    <div class="course-grid" role="list">
        {% set courses = page.children %}
        
        {% for course in courses %}
            {# Use Card Component for consistent styling #}
            {% embed 'components/molecules/card.html.twig' with {
                variant: 'default',
                class: 'course-card'
            } %}
                {% block content %}
                    {% if course.media.images|first %}
                        {% set image = course.media.images|first %}
                        <div class="card-image">
                            {{ image.cropZoom(800,500).html('', course.title, 'course-thumbnail')|raw }}
                        </div>
                    {% endif %}
            
                    <div class="course-content">
                        <h2>{{ course.title }}</h2>
            
                        {# Use Meta Info Component #}
                        {% if course.header.instructor or course.header.duration or course.header.level %}
                            {% set meta_items = [] %}
                            {% if course.header.instructor %}
                                {% set meta_items = meta_items|merge([{icon: 'fa-user', text: course.header.instructor}]) %}
                            {% endif %}
                            {% if course.header.duration %}
                                {% set meta_items = meta_items|merge([{icon: 'fa-clock-o', text: course.header.duration}]) %}
                            {% endif %}
                            {% if course.header.level %}
                                {% set meta_items = meta_items|merge([{icon: 'fa-signal', text: course.header.level}]) %}
                            {% endif %}
                            
                            {% include 'components/molecules/meta-info.html.twig' with {
                                items: meta_items,
                                class: 'course-meta'
                            } %}
                        {% endif %}
            
                        <div class="course-description">
                            {{ course.header.short_description|default(course.summary|striptags|slice(0, 180) ~ '...') }}
                        </div>
                    </div>
                {% endblock %}
                
                {% block actions %}
                    {# Use Button Component #}
                    {% include 'components/atoms/button.html.twig' with {
                        text: 'THEME_MY_QUARK.VIEW_DETAILS'|t,
                        url: course.url,
                        variant: 'primary',
                        attrs: {'data-agent-action': 'view_course'}
                    } %}
                {% endblock %}
            {% endembed %}
        {% endfor %}

        {% if courses|length == 0 %}
            <p class="no-courses">{{ 'THEME_MY_QUARK.NO_COURSES'|t }}</p>
        {% endif %}
    </div>
{% endblock %}
